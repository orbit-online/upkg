{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "additionalProperties": false,
  "properties": {
    "$schema": { "type": "string" },
    "name": {
      "description": "The name of this package. This will become the directory link name in .upkg/ of the parent package.\nA starting period (.), slashes (/), and newlines (\\n) will silently be replaced with underscore (_)",
      "$ref": "#/definitions/name"
    },
    "update": { "$ref": "#/definitions/update" },
    "version": { "type": "string" },
    "dependencies": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/dependency"
      }
    }
  },
  "definitions": {
    "name": {
      "type": "string",
      "pattern": "^[^.][^/\\n]*$"
    },
    "update": {
      "description": "Path (relative to this upkg.json) and args to an executable that returns the path or URL to a newer version of this package.\nDefault: None",
      "type": "array",
      "items": {
        "type": "string"
      }
    },
    "sha256": {
      "type": "string",
      "pattern": "^[0-9a-f]{64}$"
    },
    "sha1": {
      "type": "string",
      "pattern": "^[0-9a-f]{40}$"
    },
    "dependency": {
      "anyOf": [
        { "$ref": "#/definitions/tar" },
        { "$ref": "#/definitions/file" },
        { "$ref": "#/definitions/file-no-exec" },
        { "$ref": "#/definitions/git" }
      ]
    },
    "tar": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "tar": {
          "description": "The path or URL to a tar archive\nRequired",
          "type": "string"
        },
        "sha256": {
          "description": "The SHA-256 checksum of the archive\nRequired",
          "$ref": "#/definitions/sha256"
        },
        "name": {
          "description": "A name override for the extracted archive directory.\nThis will become the directory link name in .upkg/ of the parent package.\nA starting period (.), slashes (/), and newlines (\\n) will silently be replaced with underscore (_).\n\nDefault: The basename of the path or URL",
          "$ref": "#/definitions/name"
        },
        "bin": {
          "description": "Whether there should be placed links in .upkg/.bin (and /usr/local/bin or $HOME/.local/bin when installing globally) to all executable files found in the bin/ directory of the package.\nDefault: true",
          "const": false,
          "type": "boolean"
        },
        "update": { "$ref": "#/definitions/update" }
      }
    },
    "file": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "file": {
          "description": "The path or URL to a file\nRequired",
          "type": "string"
        },
        "sha256": {
          "description": "The SHA-256 checksum of the file\nRequired",
          "$ref": "#/definitions/sha256"
        },
        "name": {
          "description": "A name override for this file.\nThis will become the directory link name in .upkg/ of the parent package.\nA starting period (.), slashes (/), and newlines (\\n) will silently be replaced with underscore (_).\nDefault: The basename of the path or URL",
          "$ref": "#/definitions/name"
        },
        "bin": {
          "description": "Whether the file should be linked to from .upkg/.bin (and /usr/local/bin or $HOME/.local/bin when installing globally)\nDefault: true",
          "const": false,
          "type": "boolean"
        },
        "update": { "$ref": "#/definitions/update" }
      },
      "required": ["file", "sha256"]
    },
    "file-no-exec": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "file": {
          "description": "The path or URL to a file\nRequired",
          "type": "string"
        },
        "sha256": {
          "description": "The SHA-256 checksum of the file\nRequired",
          "$ref": "#/definitions/sha256"
        },
        "name": {
          "description": "A name override for this file.\nThis will become the directory link name in .upkg/ of the parent package.\nA starting period (.), slashes (/), and newlines (\\n) will silently be replaced with underscore (_).\nDefault: The basename of the path or URL",
          "$ref": "#/definitions/name"
        },
        "exec": {
          "description": "false implies link=false. Whether the file should be made executable (chmod +x).\nDefault: true",
          "const": false,
          "type": "boolean"
        },
        "update": { "$ref": "#/definitions/update" }
      },
      "required": ["file", "sha256", "exec"]
    },
    "git": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "git": {
          "description": "The path or URL to a git repository",
          "type": "string"
        },
        "name": {
          "description": "A name override for the cloned repository.\nThis will become the directory link name in .upkg/ of the parent package.\nA starting period (.), slashes (/), and newlines (\\n) will silently be replaced with underscore (_).\nDefault: The basename of the path or URL",
          "$ref": "#/definitions/name"
        },
        "bin": {
          "description": "Whether there should be placed links in .upkg/.bin (and /usr/local/bin or $HOME/.local/bin when installing globally) to all executable files found in the bin/ directory of the package.\nDefault: true",
          "const": false,
          "type": "boolean"
        },
        "sha1": {
          "description": "The SHA-1 git commit hash to checkout\nRequired",
          "$ref": "#/definitions/sha1"
        },
        "update": { "$ref": "#/definitions/update" }
      }
    }
  }
}
